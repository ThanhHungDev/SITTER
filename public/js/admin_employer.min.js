var LIST_ITEM_SITTER=null,EMPL_ID=null,EMPL_EMAIl=null;function deleteEmployer(){let t=$('input[name="idDelete"]').val();ajaxDeleteEmployer($('input[name="actionDelEmp"]').val(),t)}function ajaxDeleteEmployer(t,e){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:t,type:"post",data:{id:e},dataType:"json",success:function(t){200==t.code?($.toast({heading:"Success!",text:t.messages,showHideTransition:"slide",icon:"success",position:"top-right"}),location.reload()):$.toast({heading:"Error!",text:t.messages,showHideTransition:"slide",icon:"error",position:"top-right"})}})}function ajaxGetDetailsEmployer(t){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:t.action,type:"post",data:{id_profile:t.profileId,id_user:t.userId},dataType:"json",success:function(t){(t.code=200)?(fillDataToModal(t.data),resendUpdateProfileEmp(t.dataToken),$("#details-employer-modal").modal({closeClass:"popup-lose",escapeClose:!1,showClose:!1})):$.toast({heading:"Warning!",text:t.messages,showHideTransition:"slide",icon:"warning",position:"top-right"})}})}function resendUpdateProfileEmp(t){$(".link-update").css("display","none"),$("#link-update").val(""),t.admin_unaccept&&($(".link-update").css("display","block"),$("#link-update").val(t.url_update))}function fillDataToModal(t){let e=1;$(".child-info").html(""),t.forEach(function(t,a){let i="";switch(t.type){case 1:i="fa";break;case 2:i="mom";break;case 3:i="child"}if(3!=t.type&&($('p[data-name="'+i+'"]').text(t.first_name+"　"+t.last_name),$('p[data-gender="'+i+'"]').text(1==t.gender?"男性":"女性"),$('p[data-age="'+i+'"]').text(t.age_year+"歳")),3==t.type){let a=1===t.gender?"男の子":"女の子",i=!0===t.allergic?"有":"無",n=!0===t.chronic?"有":"無";$("#child-default").find('label[type="child-num"]').text("お子様"+e),$("#child-default").find('p[data-name="child"]').html(t.first_name+"　"+t.last_name),$("#child-default").find('p[data-gender="child"]').html(a),$("#child-default").find('p[data-age="child"]').html(t.age_year+"歳"+t.age_month+"ヶ月"),$("#child-default").find('p[data-alegic="child"]').html(i),$("#child-default").find('p[data-alegic-note="child"]').html(t.allergic_note),$("#child-default").find('p[data-chronic="child"]').html(n),$("#child-default").find('p[data-chronic-note="child"]').html(t.chronic_note);let s=$("#child-default").html();$(".child-info").append(s),e++}})}function ajaxListSitterModel(){let t=SYSTEM_REAL_TIME_URL+"/api/"+EMPL_ID+"/friends";$.ajax({url:t,type:"get",dataType:"json",success:function(t){(t.code=200)?setListSitter(LIST_ITEM_SITTER=t.data):$.toast({heading:"Warning!",text:t.messages,showHideTransition:"slide",icon:"warning",position:"top-right"})}})}function setListSitter(t){let e=document.getElementById("item-list-sitter");e.innerHTML="";let a=0;for(let i=0;i<t.length;i++){let n=t[i];if(n.role_id!=SITTER)continue;let s=document.createElement("div");s.classList.add("row");let o=document.createElement("div");o.classList.add("row-avatar");let l=document.createElement("img");l.setAttribute("src",n.avatar),o.appendChild(l),s.appendChild(o);let d=document.createElement("div");d.classList.add("row-info");let r=document.createElement("p");r.classList.add("info-name"),r.innerHTML=n.first_name+n.last_name,d.appendChild(r);let c=document.createElement("p");c.classList.add("info-mail"),c.innerHTML=n.email,d.appendChild(c),s.appendChild(d);let p=document.createElement("div");p.classList.add("row-action");let m=document.createElement("button");m.classList.add("action-send-mail"),m.classList.add("js-send-email"),m.setAttribute("data-empl-id",EMPL_ID),m.setAttribute("data-sitter-id",n.id),m.setAttribute("data-full-name",n.first_name+n.last_name),m.setAttribute("data-mail",EMPL_EMAIl),m.innerHTML="メール送信",p.appendChild(m),s.appendChild(p),e.appendChild(s),a++}document.getElementById("item-count").innerHTML=a+"人"}function searchSitter(t){if(LIST_ITEM_SITTER){let e=[];LIST_ITEM_SITTER.forEach(a=>{(a.first_name.indexOf(t)>0||a.last_name.indexOf(t)>0)&&e.push(a)}),setListSitter(e)}}function ajaxSendMailSitter(t,e){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:t,type:"post",data:e,dataType:"json",success:function(t){200==t.code?$.toast({text:t.messages,showHideTransition:"slide",icon:"success",position:"top-right"}):$.toast({text:t.messages,showHideTransition:"slide",icon:"warning",position:"top-right"})},error:function(t){}})}function approveProfileEmployer(t){let e=$(t).parent(),a=$(e).attr("data-id"),i=$(e).attr("data-status"),n=ADMIN_EMPLOYER_AJAX_ACCEPT,s={id:a,admin_confirm:i};$(this).prop("disabled",!0),ajaxApproveProfileEmployer(n,s,t)}function ajaxApproveProfileEmployer(t,e,a){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:t,data:e,type:"post",success:function(t){200==t.code?(e.admin_confirm==ADMIN_CONFIRM_ACCEPT&&$(a).closest(".content-approve").remove(),$.toast({heading:"Success!",text:t.messages,showHideTransition:"slide",icon:"success",position:"top-right"})):$.toast({heading:"Error!",text:t.messages,showHideTransition:"slide",icon:"error",position:"top-right"}),$(a).prop("disabled",!1)},error:function(t){$.toast({heading:"Error!",text:"Accept fail!",showHideTransition:"slide",icon:"error",position:"top-right"}),$(a).prop("disabled",!1)}})}$(document).ready(function(){$(".get-detail").click(function(){ajaxGetDetailsEmployer({action:$(this).attr("data-action"),profileId:$(this).attr("data-id-profile"),userId:$(this).attr("data-user-id")})}),$(".btn-delete").click(function(t){let e=$(this).attr("data-id");$('input[name="idDelete"]').val(e),$("#deleteEmployer").modal({closeClass:"popup-lose",escapeClose:!1,showClose:!1})}),$(".js-list-sitter").click(function(){EMPL_ID=$(this).attr("data-id"),EMPL_EMAIl=$(this).attr("data-email"),$(".search-input").val(""),ajaxListSitterModel(),$("#sitter-list-modal").modal({closeClass:"popup-lose",escapeClose:!1,showClose:!1})}),$(".js-search-item").click(function(){let t=$(".search-input").val();""!=t.trim()?searchSitter(t):setListSitter(LIST_ITEM_SITTER)}),$("#link-update").on("click",function(){let t=$(this).val(),e=$("<input>");$(this).append(e),e.val(t).select(),document.execCommand("copy"),e.remove(),$.toast({text:"コピーしました",showHideTransition:"slide",icon:"success",position:"top-right"})})}),$(document).on("click",".js-send-email",function(){let t={user_id:$(this).attr("data-empl-id"),sitter_id:$(this).attr("data-sitter-id"),full_name:$(this).attr("data-full-name"),email:$(this).attr("data-mail")};ajaxSendMailSitter(EMPLOYER_SEND_SITTER,t)}),$(".small-img").on("click",function(){let t=$(this).find("img").clone();$("#content-avatar").append(t),$("#avatar-modal").modal({escapeClose:!1,showClose:!1})}),$("#avatar-modal").on($.modal.CLOSE,function(){$("#content-avatar").empty()});
$(document).ready(function(){function n(n,e,t){n.select2({language:{errorLoading:function(){return"error"},minimumInputLength:function(){return"1文字以上入力してください"},noResults:function(){return"結果が見つかりません"},searching:function(){return"焼く..."}},ajax:{dataType:"json",delay:250,url:e,data:function(n){return{name:n.term}},processResults:function(n){return{results:n}},cache:!0,templateSelection:function(n,e){return $(n.element).attr("data-bank-code",n.id),n.text}},placeholder:t})}$("#bank-account-form").validate({onfocusout:function(n){$(n).valid()},invalidHandler:function(){$(this).find(".form-validate .error:first").focus()},rules:{account_number:{required:{depends:function(){return $.trim($(this).val())||$(this).val($.trim($(this).val())),!0}},minlength:7,maxlength:8,number:!0},account_holder_name:{required:{depends:function(){return $.trim($(this).val())||$(this).val($.trim($(this).val())),!0}},minlength:1,maxlength:255,checkKatakana:!0},bank_code:{required:{depends:function(){return $.trim($(this).val())||$(this).val($.trim($(this).val())),!0}}},branch_code:{required:{depends:function(){return $.trim($(this).val())||$(this).val($.trim($(this).val())),!0}}}},messages:{account_number:{required:"口座番号を入力して下さい。",minlength:"無効な銀行口座番号です: 7 〜 8 桁の番号を指定してください。",maxlength:"無効な銀行口座番号です: 7 〜 8 桁の番号を指定してください。",number:"口座番号は数字を入力してください。"},account_holder_name:{required:"口座名義を入力して下さい。",minlength:"口座名義は1桁以上、255桁以下でなければなりません。",maxlength:"口座名義は1桁以上、255桁以下でなければなりません。",checkKatakana:"このフィールドにはカタカナのみを使用してください。"},bank_code:{required:"銀行名を入力して下さい。"},branch_code:{required:"支店名を入力して下さい。"}},errorPlacement:function(n,e){(e=e.closest(".form-validate").find(".form-error")).html(""),n.appendTo(e)}}),jQuery.validator.addMethod("checkKatakana",function(n){return wanakana.isKatakana(n)}),$("#stripe_test_bank").on("click",function(){$("#account-number").val("0001234"),$("#account-holder-name").val("アカウントテスト"),$("#routing-number").val("1100000")}),n($("#js-bank-code"),API_SITTER_URL+"/bank-code",""),$("#js-bank-code").on("change",function(){var e=$(this).select2("data"),t=e[0].id,a=e[0].text;if($("#js-branch-code").val(""),t){$("#js-branch-code").removeAttr("disabled");let e=API_SITTER_URL+"/branch-code?bank_code="+t;n($("#js-branch-code"),e,""),$("#bank-name").val(a),$("#js-bank-code").valid()}}),$("#js-branch-code").on("change",function(){var n=$(this).select2("data"),e=n[0].id,t=n[0].text,a=$("#js-bank-code").val()+e;$("#routing-number").val(a),$("#branch-name").val(t),$("#js-branch-code").valid()}),$("#account-number").on("blur",function(){$(this).val(convertNumberJP($(this).val())),function(){let n=$("#account-number").val().trim();if(!n)return;let e=["0","1","2","3","4","5","6","7","8","9","０","１","２","３","４","５","６","７","８","９"],t=n.split(""),a="";for(let n=0;n<t.length;n++){if(!e.includes(t[n]))return void $("#account-number").val(a.trim());a+=t[n]}$("#account-number").val(a.trim())}()})});